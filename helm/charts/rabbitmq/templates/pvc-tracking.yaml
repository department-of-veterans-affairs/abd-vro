apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: {{ .Values.global.tracking.claimName }}
  annotations:
    # As an alternative to a StatefulSet (mentioned below), keep this PVC when the deploy is deleted/uninstalled.
    # Helm will no longer manage it in any way, so this PVC must be manually deleted.
    # https://helm.sh/docs/topics/charts_hooks/#hook-resources-are-not-managed-with-corresponding-releases
    helm.sh/resource-policy: keep
spec:
  accessModes:
    - ReadWriteMany
  # Until we implement a StatefulSet to retain the associated PV, use the non-retain storage class
  # so that we are not creating a bunch of orphaned PVs when deploy-app.sh calls `helm del`.
  # https://dsva.slack.com/archives/C04CA47HV96/p1671058797549319?thread_ts=1670468543.753259&cid=C04CA47HV96
  storageClassName: efs-sc
  resources:
    requests:
      storage: {{ .Values.global.tracking.storageSize }}
