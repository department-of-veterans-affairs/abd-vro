/**
 * This plugin is used to specify versions of transitive dependencies to address security vulnerability alerts.
 * If more formality is desired, convert this into a Platform -- https://docs.gradle.org/current/userguide/platforms.html#sub:platforms-vs-catalog
 *   - This would result in creating another Gradle module/subfolder, which seems unnecessary at this point.
 */
plugins {
  id 'java'
}

ext {
    mapstruct_version="1.4.2.Final"
    spring_framework_version="6.1.12"
    snakeyaml_version="2.2"
    jackson_databind_version="2.16"
    spring_core_version="6.1.12"
}

afterEvaluate {
    configurations.all {
      resolutionStrategy.dependencySubstitution {
        substitute module("org.yaml:snakeyaml") using module("org.yaml:snakeyaml:${snakeyaml_version}")
      }
    }
}

dependencies {
    // The following constraints are declared to address security vulnerabilities in prior versions.
    // Add code comments to hint about uses of each dependency.
    constraints {
        // for starter-bom
        implementation "org.springframework.boot:spring-boot-dependencies:${spring_boot_version}"
        implementation "org.springframework:spring-webmvc:${spring_framework_version}"
        implementation 'org.springframework:spring-web:6.1.12'
        implementation "org.springframework:spring-beans:${spring_framework_version}"
        implementation "org.springframework:spring-core:${spring_core_version}"
        implementation "io.github.classgraph:classgraph:4.8.149"
        implementation 'com.squareup.okhttp3:okhttp:4.12.0'

        implementation "org.yaml:snakeyaml:${snakeyaml_version}"
        implementation "org.thymeleaf:thymeleaf:3.1.2.RELEASE"      // Fix for Security vulnerability

        // for mockserver-netty and hapi-fhir
        implementation 'org.apache.commons:commons-text:1.10.0'

        // for hapi-fhir-server-openapi
        implementation 'ca.uhn.hapi.fhir:org.hl7.fhir.utilities:5.6.92'
        implementation 'ca.uhn.hapi.fhir:org.hl7.fhir.r5:5.6.92'
        implementation 'ca.uhn.hapi.fhir:org.hl7.fhir.r4b:5.6.92'
        implementation 'ca.uhn.hapi.fhir:org.hl7.fhir.convertors:5.6.92'

        implementation 'io.netty:netty-handler:4.1.100.Final'

        // For Kafka svc-bie-kafka service override
        implementation('org.xerial.snappy:snappy-java:1.1.10.4')

        implementation('com.google.guava:guava:33.0.0-jre')
        implementation 'org.bouncycastle:bcpkix-jdk18on:1.74'
        implementation 'org.webjars:swagger-ui:4.1.3'
        implementation 'org.springframework.kafka:spring-kafka:2.9.11'

        implementation 'org.apache.commons:commons-compress:1.24.0'

        // for tomcat
        implementation 'org.apache.tomcat.embed:tomcat-embed-core:10.1.25'

        implementation 'org.springframework.amqp:spring-amqp:3.0.10'
        implementation 'org.springframework.security:spring-security-config:6.1.5'

        implementation 'com.rabbitmq:amqp-client:5.18.0'

        implementation 'com.fasterxml.jackson.core:jackson-databind:2.16.0'
        implementation 'io.projectreactor.netty:reactor-netty-http:1.1.13'

        implementation 'ch.qos.logback:logback-core:1.4.14'
        implementation 'ch.qos.logback:logback-classic:1.4.14'


        // These are used indirectly but we need to specify versions, otherwise build error
        annotationProcessor "org.springframework.boot:spring-boot-autoconfigure-processor:${spring_boot_version}"
        annotationProcessor "org.mapstruct:mapstruct-processor:${mapstruct_version}"
    }
}
