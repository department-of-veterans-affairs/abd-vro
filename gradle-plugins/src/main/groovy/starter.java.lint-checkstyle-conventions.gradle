/**
 * Setting for running checkstyle
 */

plugins {
    // Apply the java Plugin to add support for Java.
    id 'checkstyle'
}

configurations {
    checkstyleRules
}

dependencies {
//    checkstyleRules platform('gov.va.starter:checkstyle-bom')
//    checkstyleRules 'gov.va.starter:checkstyle'
    implementation 'com.google.guava:guava:33.0.0-jre'
}

// Also refer to https://github.com/moznion/gradle-multi-project-checkstyle/blob/master/build.gradle
checkstyle {
    toolVersion "10.12.7"
    configFile = file('checkstyle.xml')
    if(! configFile.exists()){
        configFile = rootProject.file('settings/checkstyle/checkstyle.xml')
    }
    if(! configFile.exists()){
        config project.resources.text.fromUri(getClass().getResource('/checkstyle.xml').toURI())
    }
    // pulls configuration from the va.starter checkstyle jar:
    // config project.resources.text.fromArchiveEntry(configurations.checkstyleRules, 'checkstyle.xml')
    configProperties = [
            'checkstyle.cache.file': "${buildDir}/checkstyle.cache",
    ]
    ignoreFailures = true
    showViolations = true
}

checkstyleMain {
    source = "src/main/java"
}
checkstyleTest {
    source = "src/test/java"
}
