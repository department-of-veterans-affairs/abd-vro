name: "1. (Internal) Continuous Delivery (to DEV daily)"

on:
  schedule:
    # Run every day at 19:00 UTC
    # https://pubs.opengroup.org/onlinepubs/9699919799/utilities/crontab.html#tag_20_25_07
    - cron: '0 19 * * *'

  # Allow manual triggering
  workflow_dispatch:

jobs:
  deploy-vro-app:
    # only run in one of the repos
    if: github.repository == 'department-of-veterans-affairs/abd-vro-internal'
    name: "Deploy vro-app to ${{ inputs.target_env }}"
    uses: ./.github/workflows/update-deployment.yml
    with:
      target_env: dev
      helm_chart: vro-app
      image_tag: latest
    secrets: inherit
  deploy-vro-svcs:
    # only run in one of the repos
    if: github.repository == 'department-of-veterans-affairs/abd-vro-internal'
    name: "Deploy vro-svcs to ${{ inputs.target_env }}"
    uses: ./.github/workflows/update-deployment.yml
    with:
      target_env: dev
      helm_chart: vro-svcs
      image_tag: latest
    secrets: inherit
  deploy-domain-cc:
    # only run in one of the repos
    if: github.repository == 'department-of-veterans-affairs/abd-vro-internal'
    name: "Deploy vro-svcs to ${{ inputs.target_env }}"
    uses: ./.github/workflows/update-deployment.yml
    with:
      target_env: dev
      helm_chart: domain-cc
      image_tag: latest
    secrets: inherit
