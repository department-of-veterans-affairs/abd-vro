---
apiVersion: networking.istio.io/v1beta1
kind: VirtualService
metadata:
  name: {{ .Chart.Name }}
  namespace: {{ .Values.namespace }}
  labels: {{- toYaml .Values.labels.api | nindent 4 }}
spec:
  hosts: [{{ .Values.environment }}.lighthouse.va.gov]
  gateways: [istio-system/ldx-nonprod-1-{{ .Values.environment }}-gateway]
  http:
  - match:
    - uri:
        prefix: /{{ .Values.name }}
    route:
    - destination:
        host: {{ .Chart.Name }}
        port:
          number: 8080
    headers:
      response:
          remove:
          - Server
    