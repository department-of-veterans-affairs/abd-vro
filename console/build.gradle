plugins {
    id 'starter.std.java.library-spring-conventions'
	// Needed for bootRun task
	id 'org.springframework.boot'
	// Needed for tasks docker and dockerRun
    id 'starter.java.container-conventions'
	id 'groovy'
}

ext {
//	set('testcontainersVersion', "1.17.4")
}

dependencies {
    implementation project(':domain')

	implementation 'org.codehaus.groovy:groovy-groovysh'
//	implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
	implementation 'org.springframework.boot:spring-boot-starter-data-redis'
	implementation "org.apache.camel.springboot:camel-spring-boot-starter:${camel_version}"
	implementation 'org.codehaus.groovy:groovy'

//	developmentOnly 'org.springframework.boot:spring-boot-devtools'
	testImplementation 'org.springframework.boot:spring-boot-starter-test'
	testImplementation 'org.testcontainers:junit-jupiter'
}

//dependencyManagement {
//	imports {
//		mavenBom "org.testcontainers:testcontainers-bom:${testcontainersVersion}"
//	}
//}

docker {
    files "build/libs/${bootJar.archiveFileName.get()}", "bin/entrypoint.sh"
    buildArgs([JAR_FILE: bootJar.archiveFileName.get(), ENTRYPOINT_FILE: "entrypoint.sh"])
}
dockerRun {
	arguments '--rm', '-it'
}
bootRun {
	// Needed when running task `bootRun`
    standardInput = System.in
}
tasks.named('test') {
	useJUnitPlatform()
}
